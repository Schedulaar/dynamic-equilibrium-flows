\section{Kürzeste Wege}\label{sec-travel-times}

In diesem Abschnitt wird der Begriff der frühesten Ankunftszeit an einem Knoten eingeführt und erörtert, wann eine Kante $vw$ in einem kürzesten $s$-$w$-Pfad liegt.

\begin{definition}
	Für einen dynamischen Fluss $f$ und einen Pfad $P=(e_1,\dots,e_k)$ definiere $l^P(\theta)\coloneq T_{e_k}\circ\dots\circ T_{e_1}(\theta)$ den Zeitpunkt, an dem ein Partikel den Endknoten des Pfads erreicht, falls es den Pfad zum Zeitpunkt $\theta$ betritt.
	
	Für einen Knoten $w\in V$ beschreibe $\mathcal{P}_w$ die Menge aller $s$-$w$-Pfade.
	Dann ist die früheste Ankunft eines Partikels, das zur Zeit $\theta$ bei $s$ startet, gegeben durch $l_w(\theta)\coloneq \min_{P\in\mathcal{P}_w}l^P(\theta)$.
	Ein Pfad $P\in \mathcal{P}_w$ heißt \emph{kürzester $s$-$w$-Pfad zur Zeit $\theta$}, falls er $l_w(\theta)=l^P(\theta)$ erfüllt.
\end{definition}

\begin{proposition}\label{prop-abs-cont-sur}
	Für einen zulässigen Fluss $f$ sind die Funktionen $F_e^+$ und $F_e^-$ für alle $e\in E$ lokal absolut stetig.
	Die Funktionen $T_e$, $l^P$ sowie $l_v$ sind dabei für alle Kanten $e\in E$, Pfade $P$ in G und Knoten $v\in V$ monoton wachsend, lokal absolut stetig und surjektiv.
\end{proposition}
\begin{proof}
	Nach dem Hauptsatz der Differential- und Integralrechnung für das Lebes\-gue-Inte\-gral (siehe \cite[Kap. VII, Satz 4.14]{Elstrodt2011}) ist $G: [a,b] \to \R, x\mapsto \int_a^x g(t) \diff t$ für eine Lebesgue-integrierbare Funktion $g: [a,b] \to \R$ absolut stetig.
	Insbesondere sind also $F_e^+$ sowie $F_e^-$ und damit auch $q_e$ und $T_e$ lokal absolut stetig.
	Als Komposition bzw. punktweises Minimum endlich vieler lokal absolut stetiger Funktionen sind auch $l^P$ und $l_v$ für alle Pfade $P$ und Knoten $v$ lokal absolut stetig.
	Nach Proposition~\ref{prop-feasible-flow}~\ref{prop-feasible-flow-T-mon-inc-cont} ist die Monotonie von $T_e$ bereits gegeben, welche auch die Monotonie von $l^P$ und $l_v$ impliziert.
	Wegen $f_e^+, f_e^-\in\mathfrak{F_0}$ gilt $q_e(\theta)=0$ für $\theta\leq 0$, wodurch auch $\lim_{\theta\to-\infty} T_e(\theta) = - \infty$ folgt.
	Mit $T_e(\theta)\geq \theta$ ergibt sich die Surjektivität von $T_e$.
	Daher sind auch $l^P$ und $l_v$ surjektiv.
\end{proof}

Die Monotonie lässt sich spieltheoretisch interpretieren:
Partikel, die zur Zeit $\theta$ in $s$ starten und sich auf einem kürzesten Pfad zu $t$ begeben, kommen zur Zeit $l_t(\theta)$ in $t$ an.
Partikel, die später starten, können also nicht früher in $t$ ankommen.
Wie im statischen Szenario von kürzesten Pfaden, gilt auch hier die Dreiecksungleichung: 

\begin{lemma}\label{lemma-dreicksungl}
	Für einen zulässigen dynamischen Fluss gilt 
	$T_{vw}(l_v(\theta)) \geq l_w(\theta)$ für alle Kanten $vw\in E$.
\end{lemma}
\begin{proof}
	Sei ein kürzester $s$-$v$-Pfad $P$ zum Zeitpunkt $\theta$ gegeben.
	Hängt man an $P$ die Kante $vw$ an, erhält man einen $s$-$w$-Pfad, der zur Eintrittszeit $\theta$ die Ankunftszeit $T_{vw}(l_v(\theta))$ liefert.
	Da $l_w(\theta)$ das Minimum über die Ankunftszeit aller $s$-$w$-Pfade ist, gilt die Behauptung.
\end{proof}

\begin{definition}
	Man bezeichne eine Kante $vw\in E$ als \emph{aktiv zum Zeitpunkt $\theta$}, falls sie auf einem zur Zeit $\theta$ kürzesten $s$-$w$-Pfad liegt; sonst nennt man sie \emph{inaktiv zum Zeitpunkt $\theta$}.
	Es bezeichne $\Theta_e$ die Menge aller Zeitpunkte, zu denen die Kante $e$ aktiv ist, und $G_\theta \coloneq (V, E_\theta)$ den durch die zur Zeit $\theta$ aktiven Kanten induzierten Teilgraphen.
\end{definition}

\begin{proposition}
	Für einen zulässigen Fluss ist eine Kante $vw$ genau dann aktiv zum Zeitpunkt $\theta$, falls $T_{vw}(l_v(\theta)) = l_w(\theta)$ gilt.
	Außerdem ist die Menge $\Theta_{vw}$ abgeschlossen.
\end{proposition}
\begin{proof}
	Ist $vw$ aktiv zum Zeitpunkt $\theta$, existiert ein zur Zeit $\theta$ kürzester $s$-$w$-Pfad $P$, der die Kante $vw$ benutzt.
	Da Zyklen nach Voraussetzung eine positive Gesamtverzögerung haben, ist $P$ ein $s$-$w$-Weg, dessen letzte Kante gerade $vw$ ist.
	Sei also $Q$ das Anfangsstück von $P$ bis zum Knoten $v$.
	Dann gilt aufgrund der Monotonie $
	T_{vw}(l_v(\theta)) \leq T_{vw}( l^Q(\theta) ) = l_w(\theta),
	$
	sodass mit Lemma~\ref{lemma-dreicksungl} sogar Gleichheit gilt.
	
	Gilt umgekehrt $T_{vw}(l_v(\theta)) = l_w(\theta)$ und sei $Q$ ein kürzester $s$-$v$-Pfad, so ist der Pfad $P$, der an $Q$ noch die Kante $vw$ anhängt, ein kürzester $s$-$w$-Pfad zur Zeit $\theta$, der die Kante $vw$ benutzt.
	
	Aufgrund der Stetigkeit von $T_{vw}$ und $l_v$ ist die Menge $\Theta_{vw}$ abgeschlossen.
\end{proof}


Man beachte, dass Teilpfade kürzester Pfade im statischen Sinne wieder kürzeste Pfade sind; im dynamischen Sinne gilt dies nicht unbedingt, jedoch aber in folgendem Teilgraph:

\begin{lemma}\label{lemma-shortest-path-using-active-edges}
	Für einen zulässigen Fluss ist $G_\theta$ zu jeder Zeit $\theta$ ein azyklischer Graph, in dem $s$ jeden Knoten $v\in V$ erreichen kann.
\end{lemma}
\begin{proof}
	Angenommen, es existiere ein Zyklus $C=(e_1, \dots, e_n)$ mit ausschließlich aktiven Kanten.
	Es ist $l^C(\theta) > \theta$, da für Zyklen eine positive Gesamtverzögerung vorausgesetzt ist.
	Setzt man $v:= \tail(e_1)$, so erzeugt $l_{v}(\theta) = l^C(l_{v}(\theta)) > l_{v}(\theta)$ einen Widerspruch aufgrund der Aktivität aller Kanten.
	
	Für jeden Knoten $w\neq s$ existiert mindestens eine eingehende aktive Kante -- zum Beispiel die letzte Kante eines kürzesten $s$-$w$-Pfades, welcher wiederum existiert, weil $w$ von $s$ aus in $G$ erreichbar ist.
	Daher ist $w$ von $s$ aus auch in $G_\theta$ erreichbar.
\end{proof}

\begin{proposition}\label{prop-arrival-times-vector}
	Für einen zulässigen dynamischen Fluss $f$ ist $(l_v(\theta))_{v\in V}$ die eindeutige Lösung des Gleichungssystems
	\[ \tilde{l}_w = \begin{cases}
	\theta, & \text{falls } w=s, \\
	\min\limits_{vw\in \delta^-(w)} T_{vw}(\tilde{l}_v), & \text{sonst}.
	\end{cases} \]
\end{proposition}
\begin{proof}
	Offenbar löst $(l_v(\theta))_{v\in V}$ dieses System, da jeder Knoten $w\neq s$ eine eingehende Kante hat, welche $T_{vw}(l_v) = l_w$ erfüllt.
	Für eine Lösung $(\tilde{l}_v)_{v\in V}$ des Gleichungssystems zeige man $l_w(\theta) = \tilde{l}_w$ für jeden Knoten $w\in V$.
	Dabei ist der Teilgraph $G'=(V, E')$ mit
	\[ E' \coloneq  \{ vw \in E \mid T_{vw}(\tilde{l}_v ) = \tilde{l}_w \} \]
	ein azyklischer Graph, in dem $s$ jeden Knoten $w\in V$ erreichen kann:
	Zyklen können wegen der positiven Gesamtverzögerung nicht entstehen und jeder Knoten $w\neq s$ hat mindestens eine eingehende Kante $vw$ mit $T_{vw}(\tilde{l}_v) = \tilde{l}_w$.
	Daher ist $\tilde{l}_w$ bereits durch einen $s$-$w$-Pfad $P$ in $G'$ festgelegt auf $l^P(\theta)\geq l_w(\theta)$.
	Für einen zur Zeit $\theta$ kürzesten $s$-$w$-Pfad $Q$ gilt außerdem $\tilde{l}_w \leq T^Q(\tilde{l}_s) = T^Q(\theta) = l_w(\theta)$.
\end{proof}

Um den Vektor $(l_v(\theta))_{v\in V}$ für alle $\theta\in\R$ gleichzeitig zu berechnen, kann der Bellman-Ford-Algorithmus auf den Distanzvektor-Funktionen $(l_v)_{v\in V}$ genutzt werden:
Dazu wird in jeder der $n-1$ Iterationen für jede Kante das punktweise Minimum $l_w \coloneq  \min\{ l_w, T_{vw}\circ l_v \}$ gebildet.
Sind Operationen auf Funktionen nicht möglich oder zu teuer, so kann $(l_v(\theta))_{v\in V}$ für ein spezielles $\theta\in\R$ mit dem Dijkstra-Algorithmus ermittelt werden, wobei man die Kosten einer Kante $vw$ erst bei Scanning von $v$ in der Form $q_{vw}(l_v(\theta)) + \tau_{vw}$ berechnet.