\section{A special class of static flows}

\begin{lemma}\label{lemma-nash-flow-waiting-queue-implies-active-edge}
	Seien $f$ ein Nash-Fluss über Zeit, $uv\in E$ eine Kante und $\theta\in\R$ ein Zeitpunkt gegeben.
	Gilt eine der folgenden Aussagen, so ist $vw$ zum Zeitpunkt $\theta$ aktiv:
	\begin{enumerate}[label=(\roman*)]
		\item Es existiert ein $\varepsilon>0$ mit $x_{vw}(\theta')<x_{vw}(\theta)$ für alle $\theta'\in(\theta-\varepsilon, \theta)$.
		\item Die Ableitung $x_{vw}'(\theta)$ existiert und es gilt $x_{vw}'(\theta)> 0$.
		\item Die Wartezeit $q_{vw}$ an der Kante $vw$ ist zur Zeit $l_v(\theta)$ positiv.
	\end{enumerate}
\todo{Ich glaube das stimmt auch gar nicht: 
	Existiert zusätzlich zu (iii) die Ableitung $x'_{vw}(\theta)$, so ist diese positiv.}
\end{lemma}
\begin{proof}
	Zu Aussage (i): Für $\theta'$ gilt $F_{vw}^+(l_v(\theta')) > F_{vw}^+(l_v(\theta))$.
	Also existiert eine Teilmenge $Q_\varepsilon \subseteq (l_v(\theta-\varepsilon), l_v(\theta))=l_v((\theta - \varepsilon, \theta))$ mit positivem Maß und $f_{vw}^+\big|_{Q_\varepsilon} > 0$.
	Da $f$ ein Nash-Fluss ist, fließt $f$ nach Theorem~\ref{thm-equivalencies-nash-flow} nur entlang aktiver Kanten.
	Daher ist $\xi\in l_v(\Theta_{vw})$ für fast alle $\xi\in Q_\varepsilon$; insbesondere existiert ein $\theta_\varepsilon\in (\theta-\varepsilon, \theta)$ mit $\theta_\varepsilon\in\Theta_{vw}$.
	Für $\varepsilon\rightarrow0$ ist also auch $\theta\in\Theta_{vw}$ wegen der Abgeschlossenheit von $\Theta_{vw}$.
	
	Aussage (ii) folgt direkt aus (i) mittels Differenzenquotienten.
	Für Aussage (iii) zeige man $T_{vw}(l_v(\theta)) \leq l_w(\theta)$.
	Sei $\theta_1$ der früheste Zeitpunkt mit $F_{vw}^+(l_v(\theta_1)) = F_{vw}^+(l_v(\theta))$.
	Dieser existiert, da $F_{vw}^+(l_v(\theta))$ positiv und $l_v$ nach Proposition~\ref{prop-abs-cont-sur} surjektiv ist.
	Außerdem ist $\theta_1 \leq \theta$ wegen der Monotonie von $F_{vw}^+ \circ l_v$.
	Nach Aussage (i) gilt nun $T_{vw}(l_v(\theta_1)) = l_w(\theta_1)$.
	Nach Proposition~\ref{prop-feasible-flow}~\ref{prop-feasible-flow-queue-delay} ist $T_{vw}(l_v(\theta_1)) = T_{vw}(l_v(\theta))$ und mit der Monotonie von $l_w$ folgt $T_{vw}(l_v(\theta))\leq l_w(\theta)$.
\end{proof}

\begin{definition}[Schmaler Fluss mit Zurücksetzen]\label{def-thin-flow}
	Seien ein statischer $s$-$t$-Fluss $x'$ von Wert $F$ in einem Graph $G=(V,E)$ mit Kantenkapazitäten $u\in\R^E$, eine Quelle $s\in V$ mit Zuflusskapazität $d\in\R$ und eine Senke $t\in V$ sowie eine Teilmenge $E_1\subseteq E$ der Kanten gegeben.
	Der Fluss $x'$ heißt \emph{schmaler Fluss mit Zurücksetzen auf $E_1$}, falls eine Knotenbewertung $l'\in\R^V$ existiert, die die folgenden Bedingungen erfüllt:
	\begin{enumerate}[label=(T\arabic*)]
	\item $l_s' = F/d$,
	\item\label{def-thin-flow-x-zero} $l_w' \leq l_v'$, \tabto{4cm} für $vw\in E \setminus E_1$ mit $x'_{vw}=0$,
	\item\label{def-thin-flow-x-positive} $l_w' = \max(l_v', x'_{vw} / u_{vw} )$,  \tabto{4cm} für $vw\in E\setminus E_1$ mit $x'_{vw} > 0$,
	\item\label{def-thin-flow-resetting-edge} $l_w' = x'_{vw} / u_{vw}$,  \tabto{4cm} für $vw\in E_1$,
	
	\item\label{def-thin-flow-no-resetting-edge} $l_w' \geq \min_{vw\in \delta^-(w)} l_v'$, \tabto{4cm} falls $\delta^-(w)\cap E_1 \neq \emptyset$.
	\end{enumerate}
\end{definition}
\begin{remark}
	Hier ist, wie in~\cite[Definition 4]{Cominetti2011}, im Vergleich zu~\cite[Definition 6]{Koch2011} die Bedingung~\ref{def-thin-flow-no-resetting-edge} zusätzlich eingeführt worden.
	Diese ist nötig, um im Beweis von Theorem~\todo{asdf} zu zeigen, dass die erweiterten Ankunftszeiten tatsächlich den angegebenen übereinstimmen.
	Ohne diese Bedingung würde dies nämlich nicht gelten, wie man in Beispiel~\todo{afasdflja} erkennen kann.
\end{remark}

\begin{theorem}
	Seien ein Nash-Fluss über Zeit $f$ auf einem Graphen $G=(V,E)$ sowie ein Zeitpunkt $\theta$ gegeben.	
	Existieren die Ableitungen $x_e'(\theta)$ und $l_v'(\theta)$ für alle $e\in E$ und $v\in V$, so ist der statische $s$-$t$-Fluss $g\in\R^{E_\theta}$ mit $g_e:=x_e'(\theta)$ ein schmaler $d$-wertiger Fluss mit Zurücksetzen auf den Kanten mit Warteschlange $E_1:=\{vw\in E \mid q_{vw}(l_v(\theta))>0 \}$ im Teilgraphen der aktiven Kanten $G_\theta$.
	Als Knotenbewertung dienen dazu die Ableitungen $l_v'(\theta)$ für $v\in V$.
\end{theorem}
\begin{proof}
	zu zeigen: $l_s'(\theta) = F/d$.
	Dabei ist $l_s'(\theta) = 1$, da $l_s(\theta) = \theta$. Bleibt zu zeigen $F= d$.
	Der Wert von $g$ ist $\sum_{e\in\delta^+(s)}x_e'(\theta) =  \left.\frac{d}{dt}\sum_{e\in\delta^+(s)}F_e^+(l_s(t))\right|_{t=\theta} = \sum_{e\in\delta^+(s)} f_e^+(t)$. \todo{Geht auch mit variablen Zufluss; Problem: Warum ist Ableitung von $F_e^+$ gerade $f$? Doch nur f.ü.!}.
		
	Sei nun eine Kante $vw\in E_\theta$, also eine aktive Kante zum Zeitpunkt $\theta$, gegeben. Wir prüfen die restlichen drei Bedingungen jeweils in den folgenden drei Fällen:
	
	\begin{description}[leftmargin=0cm, topsep=0cm, itemindent=\parindent]
		\item[1. Fall:] $\exists \varepsilon > 0:\forall \theta'\in (\theta, \theta + \varepsilon ] : q_{vw}(l_v(\theta')) > 0$.
		
		Für $\theta'\in(\theta,\theta+\varepsilon]$ ist die Wartezeit $q_{vw}(l_v(\theta'))$ positiv und nach Proposition~\ref{prop-feasible-flow}~\ref{prop-feasible-flow-positive-queue} ist $q_{vw}$ positiv auf dem Intervall $[ l_v(\theta')  , l_v(\theta')+q_{vw}(l_v(\theta')) )$.
		Also ist $q_{vw}$ positiv auf dem Intervall $( l_v(\theta) , l_v(\theta + \varepsilon) + q_{vw}(l_v(\theta + \varepsilon) )
		\subseteq ( l_v(\theta) + q_{vw}(l_v(\theta)) , l_v(\theta + \varepsilon) + q_{vw}(l_v(\theta) + \varepsilon ) )$.
		
		Nach Voraussetzung ist die Kante ${vw}$ nach Lemma~\ref{lemma-nash-flow-waiting-queue-implies-active-edge} auch für $\theta'\in  (\theta, \theta + \varepsilon ]$ aktiv und es gilt $l_w(\theta') = T_{vw}(l_v(\theta')) = l_v(\theta') + q_{vw}(\theta') + \tau_{vw}$.
		Mit Bedingung~\ref{def-feasible-flow-queue-with-capacity} folgere man $x_{vw}(\theta + \varepsilon) - x_{vw}(\theta) = F_{vw}^-(l_w(\theta + \varepsilon)) - F_{vw}^-(l_w(\theta))
		= \int_{l_w(\theta)}^{l_w(\theta + \varepsilon)} f_{vw}^-(t) dt
		= \int_{l_v(\theta) + q_{vw}(\theta)}^{l_v(\theta + \varepsilon) + q_{vw}(\theta + \varepsilon)} f_{vw}^-(t + \tau_{vw}) dt
		= u_{vw} (l_w(\theta + \varepsilon) - l_w(\theta))$.
		Teilt man diese Gleichung durch $\varepsilon$, so erhält man für $\varepsilon\rightarrow 0$ die Bedingung $g_{vw} = x_{vw}'(\theta) = u_{vw} l_w'(\theta)$.
		Ist $vw\in E_1$, so ist also Bedingung~\ref{def-thin-flow-resetting-edge} erfüllt.
		Für Bedingung~\ref{def-thin-flow-x-zero} setze man $g_{vw}=x_{vw}'(\theta)=0$ voraus.
		Also ist auch $l_w(\theta)=0$ und, da $l_v$ monoton wachsend ist, gilt $0 \leq l_v'(\theta)$.

		Ist $vw\notin E_1$, ist also die Warteschlange zum Zeitpunkt $l_v(\theta)$ leer, so gilt: $l_w(\theta+\varepsilon) - l_w(\theta) = l_v(\theta + \varepsilon) + q_{vw}(l_v(\theta + \varepsilon)) - l_v(\theta) \geq l_v(\theta + \varepsilon) - l_v(\theta)$.
		Teilt man wieder durch $\varepsilon$, so erhält man für $\varepsilon  \rightarrow 0$ Bedingung~\ref{def-thin-flow-x-positive} mit $l_w'(\theta) \leq l_v'(\theta)$ und dem Resultat des letzten Absatzes.
		
		\item[2. Fall:] $\exists \varepsilon > 0: \forall \theta'\in(\theta, \theta + \varepsilon]: T_{vw}(l_v(\theta'))>l_w(\theta')$.
		
		Die Kante ${vw}$ ist also im Intervall $(\theta, \theta + \varepsilon]$ nicht aktiv.
		Nach Lemma~\ref{lemma-nash-flow-waiting-queue-implies-active-edge} ist $q_{vw} \circ l_v\big|_{(\theta, \theta+\varepsilon]}=0$ und wegen Stetigkeit ist auch $q_{vw}(l_v(\theta))=0$, was $vw\notin E_1$ impliziert.
		Da $f$ nur entlang aktiver Kanten fließt, ist außerdem $f_{vw}^+ \circ l_v \big|_{(\theta, \theta+\varepsilon)} = 0$, und es gilt $x_{vw}(\theta + \varepsilon) - x_{vw}(\theta)=0$.
		Wird durch $\varepsilon$ geteilt, so erhält man $x_{vw}'(\theta) = 0$ für $\varepsilon\rightarrow0$.
		Es muss also nur Bedingung~\ref{def-thin-flow-x-zero} geprüft werden:
		
		Da $uv$ zum Zeitpunkt $l_v(\theta)$ noch aktiv ist, folgt $l_w(\theta + \varepsilon) - l_w(\theta) < l_v(\theta+\varepsilon) - l_w(\theta) + \tau_{vw} = l_v(\theta + \varepsilon) - l_v(\theta)$.
		Teilt man diese Ungleichung  durch $\varepsilon$, so erhält man für $\varepsilon\rightarrow 0$ die Bedingung $l_w'(\theta)\leq l_v'(\theta)$.
		
		\item[3. Fall:] $\forall \varepsilon>0: \exists \theta_{\varepsilon}\in (\theta, \theta+\varepsilon]: T_{vw}(l_v(\theta_\varepsilon)) = l_w(\theta_\varepsilon)$.
		
		Dies ist die exakte Umkehrung der Bedingung von Fall 2.
		Zusätzlich betrachte man diesen Fall nur, falls Fall 1 nicht eintritt.
		Das heißt, für alle $\theta_\varepsilon$ existiert ein $\theta'\in(\theta, \theta_\varepsilon]$ mit $q_{vw}(l_v(\theta')) = 0$; insbesondere ist $q_{vw}(l_v(\theta))= 0$, wodurch $vw$ nicht in $E_1$ enthalten ist.
		Man wähle $\theta'_\varepsilon:=\max\{ \theta'\in (\theta, \theta_\varepsilon] \mid q_{vw}(l_v(\theta')) = 0 \}$ als das Maximum solcher Zeitpunkte $\theta'$, welches aufgrund der Stetigkeit von $q_{vw}\circ l_u$ existiert.
		Nach Konstruktion ist $q_{vw}\circ l_v$ im Intervall $(\theta_\varepsilon', \theta_\varepsilon)$ positiv und nach Lemma~\ref{lemma-nash-flow-waiting-queue-implies-active-edge} ist die Kante $vw$ in diesem Intervall aktiv.
		Ist dieses Intervall nicht-leer, so ist $vw$ auch zum Zeitpunkt $\theta_\varepsilon'$ wegen der Stetigkeit von $T_{vw}\circ l_v$ und $l_w$ aktiv.
		Ansonsten ist $\theta_\varepsilon'=\theta_\varepsilon$ trotzdem eine Zeit, zu der $vw$ aktiv ist.
		Also gilt $l_w(\theta_\varepsilon') - l_w(\theta) = l_v(\theta_\varepsilon') - l_v(\theta)$.
		Bedingung~\ref{def-thin-flow-x-zero} wird erfüllt, indem man durch $\theta_\varepsilon'-\theta$ teil und $l_w'(\theta) = l_v'(\theta)$ für $\varepsilon\rightarrow0$ erhält.
		
		Für Bedingung~\ref{def-thin-flow-x-positive} bleibt zu zeigen, dass $x_{vw}'(\theta) /u_{vw}\leq l_w'(\theta)$ gilt.
		Wegen Bedingung~\ref{def-feasible-flow-capacity} ist $x_{vw}(\theta + \varepsilon)-x_{vw}(\theta) = \int_{l_w(\theta+\varepsilon)}^{l_w(\theta)} f_{vw}^-(t) dt\leq (l_w(\theta + \varepsilon) - l_w(\theta)) u_{vw}$ für beliebiges $\varepsilon>0$.
		Durch Teilen mit $\varepsilon u_{vw}$ erhält man das gewünschte Resultat für $\varepsilon\rightarrow 0$.
		\todo{Add proof of (T5)}
	\end{description}
\vspace{-1.2 \baselineskip}\end{proof}

\begin{definition}
	Ein \emph{Fluss über Zeit $f$ mit Zeithorizont $T>0$} ist ein Fluss, für dessen Zufluss $d(\theta)= 0$ für $\theta\geq T$ gilt.
\end{definition}

\begin{definition}
	Seien ein Nash-Fluss über Zeit $f$ mit Zeithorizont $T$ sowie dessen induzierter schmaler Fluss mit Zurücksetzen im Graphen $G_T$ zum Zeitpunkt $T$ und ein $\alpha > 0$ gegeben.
	
	\todo{Brauche vermutlich sowas wie $f_{vw}^+(\geq l_v(\theta))=0$}
	
	Man erhalte die \emph{$\alpha$-Erweiterung $\tilde{f}$ von $f$}, indem man die Werte aus $f$ übernehme und für alle zur Zeit $T$ aktiven Kanten $vw\in E_T$ den Zu- bzw. Abfluss setze auf
	$$\tilde{f}_{vw}^+(\theta):= \frac{x_{vw}'}{l_v'} \text{ für $\theta\in (l_v(T), l_v(T)+\alpha l_v']$ und } \tilde{f}_{vw}^-(\theta):=\frac{x_{vw}'}{l_w'} \text{ für $\theta\in (l_w(T), l_w(T)+\alpha l_w']$.}$$
\end{definition}

\begin{lemma}
	Für jede $\alpha$-Erweiterung $\tilde{f}$ eines Nash-Flusses über Zeit $f$ mit Zeithorizont $T$, die für alle Kanten mit positiver Warteschlange zum Zeitpunkt $T$ die Bedingung
	$$l_w(T) - l_v(T) + \alpha(l_w' - l_v') \geq \tau_{vw}$$
	erfüllt, gelten die folgenden Aussagen:
	\begin{enumerate}[label=(\roman*)]
		\item Gilt $x_{vw}' > 0$, so ist $l_w(T) + (\theta - T)l_w' \geq l_v(T) + (\theta - T)l_v' + \tau_{vw}$ für $\theta\in[T, T+\alpha]$, und für alle $vw\in E $ und $\theta \leq l_v(T)$ gilt  $\tilde{f}^-_{vw}(\theta + \tau_{vw})=f^-_{vw}(\theta + \tau_{vw})$.
		Insbesondere ist $\tilde{q}_e(\theta) = q_e(\theta)$ und $\tilde{T}_e(\theta) = T_e(\theta)$ für $\theta \leq l_v(T)$.
		\item Der Fluss $\tilde{f}$ ist zulässiger Fluss über Zeit mit Zeithorizont $T+\alpha$.
		\item Gilt zusätzlich für alle zum Zeitpunkt $T$ inaktiven Kanten die Bedingung $$
		l_w(T) - l_v(T) + \alpha(l_w' -l_v') \leq \tau_{vw},
		$$
		so sind die $\tilde{f}$ zugeordneten frühesten Ankunftszeiten $\tilde{l}_v(\theta)$ für $\theta \leq T+\alpha$ durch
		$$\tilde{l}_v(\theta) = \begin{cases}
		l_v(\theta), & \text{ falls $\theta < T$,} \\
		l_v(T) + (\theta - T) l_v', & \text{ falls $\theta \in [T, T+\alpha]$.}
		\end{cases}$$
		gegeben und der Fluss $\tilde{f}$ ist Nash-Fluss über Zeit.
	\end{enumerate}
\end{lemma}
\begin{proof}
	Zu $(i)$: Ist $vw\in E_1$ mit $l_w'<l_v'$, so gilt
	$l_w(T)-l_v(T) + (\theta - T)(l_w' - l_v') \geq l_w(T)-l_v(T)+\alpha(l_w'- l_v')\geq \tau_{vw}$  mit der Voraussetzung an $\alpha$.
	Sonst gilt $l_w' \geq l_v'$ nach Bedingung~\ref{def-thin-flow-x-positive} und mit $T\in \Theta_{vw}$ folgt $l_w(T)+(\theta-T)l_w'=l_v(T) + q_{vw}(l_v(T))+\tau_{vw}+(\theta - T)l_w' \geq l_v(T) + (\theta-T)l_v'+\tau_{vw}$.
	Daraus folgt mit $\theta + \tau_{vw} \leq l_v(T) + \tau_{vw} \leq l_w(T)$ auch sofort $\tilde{f}_{vw}^-(\theta + \tau_{vw}) = f_{vw}^-(\theta + \tau_{vw})$ für $\theta\leq l_v(T)$.
	Insbesondere gilt $\tilde{q}_{vw}(\theta) = q_{vw}(\theta)$ und sogar $ \tilde{T}_{vw}(\theta)= T_{vw}(\theta)$ für $\theta \leq l_v(T)$.
	
	Um zu zeigen, dass $\tilde{f}$ zulässig ist, zeige man die Eigenschaften \ref{def-feasible-flow-capacity}-\ref{def-feasible-flow-queue-with-capacity}.
	Die Bedingung~\ref{def-feasible-flow-no-flow-at-node} gilt, da $x'$ ein statischer $s$-$t$-Fluss ist und Flusserhaltung in $V\setminus \{ v, t \}$ erfüllt.
	Für die Bedingungen~\ref{def-feasible-flow-capacity}, \ref{def-feasible-flow-no-negative-flow} und \ref{def-feasible-flow-queue-with-capacity} genügt es, Kanten $e\in E_T$ mit $x_e' > 0$ zu prüfen, da sonst $\tilde{f}$ mit $f$ übereinstimmt und $f$ bereits zulässig ist.
	Man nehme also $x_{vw}' > 0$ und $vw\in E_T$ an.
	Es gilt die Kapazitätsbeschränkung \ref{def-feasible-flow-capacity}, da $l_w'\geq x_{vw}' / u_{vw}$ wegen~\ref{def-thin-flow-x-positive} und~\ref{def-thin-flow-resetting-edge} gilt, wodurch $\tilde{f}^-_{vw}(\theta)=x_{vw}'/l_w'\leq u_{vw}$ für $\theta\in(l_w(T), l_w(T)+\alpha l_w']$ folgt.
	
	Für \ref{def-feasible-flow-no-negative-flow} zeige man $\tilde{F}^+_{vw}(\theta)\geq \tilde{F}_{vw}^-(\theta+\tau_{vw})$ für alle $\theta\in\R$.
	Für $\theta\leq l_v(T)$ gilt dies bereits nach (i).
	Existiert ein $\gamma\leq\alpha$ mit $\theta=l_v(T) + \gamma l_v'$, so gilt:
	\begin{equation}\label{eq-extension-nash-flow}
	\tilde{F}_{vw}^+(l_v(T) + \gamma l_v')=F_{vw}^+(l_v(T))+\gamma x_{vw}' = F_{vw}^-(l_w(T))+ \gamma x_{vw}'= \tilde{F}_{vw}^-(l_w(T)+\gamma l_w').
	\end{equation}
	Daraus folgt die Aussage, da $\theta + \tau_{vw}\geq l_w(T) + \gamma l_w'$ nach (i) erfüllt ist.
	Für $\theta > l_v(T)+\alpha l_v'$ gilt $\tilde{F}_{vw}^+(\theta) = \tilde{F}_{vw}^+(l_v(T) + \alpha l_v') = \tilde{F}_{vw}^-(l_w(T) + \alpha l_w') \geq \tilde{F}_{vw}^-(\theta + \tau_{vw})$.
	
	Es bleibt Bedingung \ref{def-feasible-flow-queue-with-capacity} zu prüfen, d.h. Warteschlangen sollen mit der Kantenkapazität abgebaut werden.
	Sei also $\tilde{q}_{vw}(\theta)$ positiv.
	Nach (i) ist $\tilde{f}^-(\theta + \tau_{vw}) = f^-(\theta + \tau_{vw}) = u_{vw}$ für $\theta\leq l_v(T)$.
	Ist $\theta > l_v(T)$, so unterscheide man, ob die Warteschlange von $vw$ zur Zeit $T$ positiv ist:
	Ist dies der Fall, so gilt $l_w' = x_{vw}' / u_{vw}$ nach~\ref{def-thin-flow-resetting-edge}, und ohne Einschränkung gelte $\theta + \tau_{vw} \geq l_w(T)$, denn $f_{vw}^-$ ist nach Proposition~\ref{prop-feasible-flow}~\ref{prop-feasible-flow-positive-queue} und Eigenschaft~\ref{def-feasible-flow-queue-with-capacity} konstant $u_{vw}$ auf $[l_v(T)+\tau_{vw},l_w(T))$.
	Existiert ein $\gamma\in [0, \alpha]$ mit $\theta = l_v(T) + \gamma l_v'$, so gilt $\theta + \tau_{vw} = l_v(T) + \gamma l_v' + \tau_{vw} \leq l_w(T) + \gamma l_w'$ nach (i).
	Damit ist $\tilde{f}^-_{vw}(\theta + \tau_{vw}) = x_{vw}'/l_w' = u_{vw}$.
	Ist  hingegen $\theta > l_v(T) + \alpha l_v'$, so gilt $0<\tilde{F}^+_{vw}(\theta) - \tilde{F}_{vw}^-(\theta +\tau_{vw}) = \alpha x_{vw}' - \min \{ \alpha l_w', \theta + \tau_{vw} - l_w(T) \} x_{vw}' / l_w'$. Insbesondere ist also $\theta + \tau_{vw} < l_w(T) + \alpha l_w'$ und auch hier gilt $\tilde{f}^-_{vw}(\theta + \tau_{vw}) = x_{vw}'/l_w' = u_{vw}$.	
	Nun betrachte man Kanten $vw$, die zum Zeitpunkt $l_v(T)$ keine Warteschlange haben.
	Nach~\ref{def-thin-flow-x-positive} gilt hier $l_w' = \max \{ l_v', x_{vw}' / u_{vw}  \}$.
	Existiert ein $\gamma\in [0, \alpha]$ mit $\theta = l_v(T) + \gamma l_v'$, so ist $\theta+\tau_{vw}$ in $[l_w(T), l_w(T) + \alpha l_w']$ enthalten und es gilt $0<\tilde{F}_{vw}^+(\theta) - \tilde{F}_{vw}^-(\theta + \tau_{vw})= \gamma x_{vw}' - \gamma l_v' x_{vw}'/l_w'$.
	Daher ist $l_w' > l_v'$ und es müssen $l_w' = x_{vw}'/u_{vw}$ und $\tilde{f}_{vw}^-(\theta + \tau_{vw}) = u_{vw}$ gelten.
	Für $\theta > l_v(T) + \alpha l_v'$ gilt $\theta + \tau_{vw} > l_w(T) + \alpha l_v'$ und $0 < \tilde{F}_{vw}^+(\theta) - \tilde{F}_{vw}^-(\theta + \tau_{vw}) = \alpha x_{vw}' - \min \{ \alpha l_w', \theta - l_v(T) \}x_{vw}'/l_w'$.
	Insbesondere ist $\theta - l_v(T) < \alpha l_w'$, was äquivalent zu $\theta + \tau_{vw} < l_w(T) + \alpha l_w'$ ist.
	Nun kann man $l_v' < l_w'$ folgern, was $l_w' = x_{vw}'/u_{vw}$ impliziert.
	Damit gilt $\tilde{f}^-(\theta + \tau_{vw}) = u_{vw}$.

	Um Aussage (iii) zu zeigen, bemerke man, dass $(l_v(\theta))_{v\in V}$ das Gleichungssystem in Proposition~\ref{prop-arrival-times-vector} für $\theta \leq T$ erfüllt, da $\tilde{T}_{vw}(\theta) = T_{vw}(\theta)$ für $\theta\leq T$ nach (i) gilt.
	Für $\theta \in (T, T+\alpha)$ löst $(l_v(T) + (\theta - T)l_v')_{v\in V}$  das System:
	\todo{Wegen $l_s' = 1$ gilt} $l_s(T) + (\theta - T)l_v' = \theta$.
	Für $w\neq s$ ist $l_w(T) + (\theta - T) l_w'$ eine untere Schranke für zur Zeit $T$ inaktive Kanten $vw$:
	Zunächst zeige man $l_w(T) + (\theta - T)l_w' \leq l_v(T) + (\theta - T)l_v' + \tau_{wv}$:
	Ist $l_w' \leq l_v'$, so gilt dies bereits, da $vw$ zur Zeit $l_v(T)$ keine Warteschlange hat.
	Für $l_w' \geq l_v'$ gilt $l_w(T) - l_v(T) + (\theta - T) (l_w' - l_v') \leq l_w(T) - l_v(T) + \alpha (l_w' - l_v') \leq \tau_{vw}$ mit der zusätzlichen Voraussetzung an~$\alpha$.
	Demnach ist also $l_w(T) + (\theta - T) l_w' \leq l_v(T) + (\theta - T) l_v' + \tau_{vw} \leq \tilde{T}(l_v(T) + (\theta - T) l_v')$.
	
	Im nächsten Schritt zeige man $\tilde{T}(l_v(T) + (\theta - T)l_v') = l_w(T) + (\theta - T) l_w'$ für Kanten $vw\in E_T$, für die $x_{vw}'$ positiv ist oder deren Warteschlange zur Zeit $l_v(T)$ positiv ist:
	Für $x_{vw}' > 0$ impliziert die Gleichung~\ref{eq-extension-nash-flow} bereits $\tilde{T}_{vw}(l_v(T) + (\theta-T)l_v') = l_w(T) + (\theta - T) l_w'$.
	Für $vw\in E_1$ gilt $l_w' = x_{vw}' / u_{vw}$ nach~\ref{def-thin-flow-resetting-edge}.
	Entsprechend erfüllt die Warteschlange
	\begin{align*}
	\tilde{z}_{vw}(l_v(T) + (\theta - T)l_v') - z_{vw}(l_v(T)) &= (\theta - T) x_{vw}' - \int_{l_v(T) + \tau_{vw}}^{l_v(T) + (\theta - T) l_v' + \tau_{vw}} f_e^-(t) \diff t \\
	&= (\theta - T) (x_{vw}' -l_v' u_{vw}),
	\end{align*}
	da zusätzlich $(\theta-T) l_v' \leq \alpha (l_v' - l_w') \leq q_{vw}(l_v(T))$ gilt.
	Daher ist $\tilde{T}(l_v(T) + (\theta - T)l_v') = l_w(T) + (\theta - T) l_v'  + \tilde{q}_{vw}(l_v(T) + (\theta - T)l_v')- q_{vw}(l_v(T)) = l_w(T) + (\theta - T) l_w'$.
	
	Zuletzt betrachten wir aktive Kanten $vw\notin E_1$ mit $x_{vw}' = 0$.
	Hier gilt $l_w(T) = l_v(T) + \tau_{vw}$ und $l_w' \leq l_v'$ nach~\ref{def-thin-flow-x-zero}.
	Außerdem ist $z_{vw}(l_v(T) + (\theta - T) l_v') = F_{vw}^+(l_v(T)) - F_{vw}^-(l_w(T)) = 0$, wodurch man $\tilde{T}(l_v(T) + (\theta - T) l_v') = l_w(T) + (\theta - T)l_v' \leq l_w(T) + (\theta - T) l_w'$ folgern kann.
	Dabei gilt sogar Gleichheit nach~\ref{def-thin-flow-no-resetting-edge}, falls $w$ keine eingehende Kante mit positiver Warteschlange hat.
	Daher ist $l_w(T)+(\theta - T) l_w'$ nicht nur eine untere Schranke, sondern tatsächlich das Minimum.
	\todo{Why Nash-Flow}
\end{proof}

\begin{example}
	\todo{Add this example}
\end{example}